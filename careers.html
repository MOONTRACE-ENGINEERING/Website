<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Careers at Moontrace Engineering</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="assets/finalbg.png" />
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #1a1a1a;
        }
        .card {
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.05), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            transition: all 0.3s ease-in-out;
        }
        .card:hover {
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            transform: translateY(-5px);
        }
        .job-card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, padding-top 0.5s ease-in-out, padding-bottom 0.5s ease-in-out;
            padding-top: 0;
            padding-bottom: 0;
        }
        .job-card-content.open {
            max-height: 2000px;
            padding-top: 1.25rem;
            padding-bottom: 1.25rem;
        }
        .job-card-icon {
            transition: transform 0.3s ease;
            font-size: 1.5rem;
            font-weight: 300;
        }
        .job-card-header.open .job-card-icon {
            transform: rotate(45deg);
        }
        .form-input, .form-textarea {
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.4);
        }
        .form-field-label {
            font-weight: 600;
            color: #374151;
        }
        .apply-now-button {
             background-color: #111827;
             color: white;
             border-radius: 0.5rem;
             padding: 0.5rem 1.5rem;
             font-weight: 600;
             transition: background-color 0.2s;
        }
        .apply-now-button:hover {
            background-color: #374151;
        }
        .filter-button {
            background-color: #e5e7eb;
            color: #374151;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: 500;
            transition: all 0.2s;
            border: 1px solid transparent;
        }
        .filter-button:hover {
            background-color: #d1d5db;
        }
        .filter-button.active {
            background-color: #111827;
            color: white;
            border-color: #111827;
        }

        /* CSS for dynamic text animation */
        .fade-in-out {
            opacity: 0;
            transition: opacity 0.5s ease-in-out; /* Removed transform for no movement */
            display: inline-block; /* Ensures min-width works */
            min-width: 250px; /* Adjust this value based on the longest text to prevent layout shift */
        }
        .fade-in-out.show {
            opacity: 1;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        /* Important: Ensure this class overrides the default display property when active */
        .modal-overlay:not(.hidden-display) {
            display: flex; /* Or block, depending on desired base layout */
        }

        .modal-overlay.hidden-display { /* New class to fully hide the modal */
            display: none;
        }
        .modal-content {
            background-color: white;
            padding: 2.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            position: relative;
            transform: translateY(20px) scale(0.95);
            transition: all 0.3s ease-out;
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0) scale(1);
        }
        .modal-close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.75rem;
            color: #666;
            cursor: pointer;
            transition: color 0.2s;
        }
        .modal-close-button:hover {
            color: #333;
        }
        /* Custom Message Box for alerts */
        .message-box {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            color: white;
            font-weight: 500;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        .message-box.show {
            opacity: 1;
        }
        .message-box.error {
            background-color: #dc2626; /* red-600 */
        }
        .message-box.success {
            background-color: #16a34a; /* green-600 */
        }
    </style>
</head>
<body class="antialiased">

    <header id="header" class="bg-white/95 backdrop-blur-md sticky top-0 z-50 border-b border-gray-200 h-16 md:h-20">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-full">
            <a href="index.html" class="text-xl tracking-wider flex items-center gap-2">
                <span class="font-bold text-black text-lg md:text-xl">MOONTRACE</span>
                <span class="font-normal text-red-600 text-base md:text-lg">|</span>
                <span class="font-normal text-gray-700 text-base md:text-lg">ENGINEERING</span>
            </a>
            <!-- Desktop Button -->
            <a href="index.html" class="hidden sm:inline-block bg-black text-white px-5 py-2.5 rounded-lg font-semibold text-sm hover:bg-gray-800 transition">Back to Main Site</a>
            <!-- Mobile Menu Button -->
            <button id="mobile-menu-toggle" class="sm:hidden flex items-center px-3 py-2 border rounded text-gray-700 border-gray-300 hover:bg-gray-100 focus:outline-none" aria-label="Open menu">
                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16"/>
                </svg>
            </button>
        </nav>
        <!-- Mobile Menu Dropdown -->
        <div id="mobile-menu" class="sm:hidden absolute top-full left-0 w-full bg-white border-b border-gray-200 shadow-lg hidden">
            <div class="px-4 py-4 flex flex-col gap-2">
                <a href="index.html" class="bg-black text-white px-5 py-2.5 rounded-lg font-semibold text-sm hover:bg-gray-800 transition text-center">Back to Main Site</a>
            </div>
        </div>
    </header>

    <main>
        <section id="careers-hero" class="py-16 sm:py-20 bg-gradient-to-r from-blue-300 to-blue-600 text-white">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h1 class="text-4xl font-extrabold tracking-tight sm:text-5xl">
                    Join Our Journey
                </h1>
                <p class="mt-4 max-w-3xl mx-auto text-lg">
                    At Moontrace, we're building the future of post-quantum cybersecurity. We're a passionate, tight-knit team valuing ownership, curiosity, and a drive to solve hard problems. If you're excited to build from the ground up, explore our open roles.
                </p>
            </div>
        </section>

        <!-- Our Philosophy Section -->
        <section id="our-philosophy" class="py-16 bg-white">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">Our Philosophy: <span id="dynamic-philosophy-text" class="fade-in-out"></span></h2>
                <p class="mt-4 max-w-3xl mx-auto text-lg text-gray-600">
                    As a pre-revenue startup, we're investing in a long-term vision. We seek brilliant, passionate minds who are eager to make a significant impact and grow with us. Your contributions will be rewarded with meaningful equity and the opportunity to shape the future of cybersecurity.
                </p>
                <div class="mt-8">
                    <a href="assets/pdfs/Contributor_policy.pdf" target="_blank" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-gray-950 hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-700 transition">
                        Read Our Contributor Policy
                        <svg class="ml-2 -mr-1 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path fill-rule="evenodd" d="M10.293 15.707a1 1 0 010-1.414L14.586 10l-4.293-4.293a1 1 0 111.414-1.414l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                            <path fill-rule="evenodd" d="M4.293 15.707a1 1 0 010-1.414L8.586 10 4.293 5.707a1 1 0 011.414-1.414l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                        </svg>
                    </a>
                </div>
            </div>
        </section>

        <!-- Advisor Invitation Section -->
        <section id="advisor-invitation" class="py-16 bg-blue-100">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-3xl font-bold tracking-tight text-blue-900 sm:text-4xl">
                    Shape the Future: Join Our Advisory Board
                </h2>
                <p class="mt-4 max-w-3xl mx-auto text-lg text-blue-800">
                    We are actively seeking visionary industry experts and esteemed professors to join Moontrace Engineering as potential advisors. Your invaluable insights and strategic guidance will directly contribute to our mission of advancing post-quantum cybersecurity.
                    We are offering meaningful equity in exchange for your time and expertise, recognizing the profound impact you can have on our journey.
                </p>
                <div class="mt-8">
                    <button id="express-interest-advisor" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-700 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition">
                        Express Interest
                        <svg class="ml-2 -mr-1 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
                            <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
                        </svg>
                    </button>
                </div>
            </div>
        </section>

        <!-- Company Culture & Benefits Section -->
        <section id="culture-benefits" class="py-16 bg-white">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl mb-12">Our Culture & Benefits</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="p-6">
                        <div class="text-blue-600 mb-4 flex justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Impact-Driven Work</h3>
                        <p class="text-gray-600">Solve real-world, high-stakes cybersecurity challenges that protect global infrastructure and data.</p>
                    </div>
                    <div class="p-6">
                        <div class="text-blue-600 mb-4 flex justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.206 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.794 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.794 5 16.5 5c1.706 0 3.332.477 4.5 1.253v13C19.832 18.477 18.206 18 16.5 18c-1.706 0-3.332.477-4.5 1.253" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Continuous Learning</h3>
                        <p class="text-gray-600">Access to cutting-edge research, conferences, and a team of experts in quantum and cryptography.</p>
                    </div>
                    <div class="p-6">
                        <div class="text-blue-600 mb-4 flex justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Flexible Work</h3>
                        <p class="text-gray-600">Enjoy the flexibility of remote work options and a focus on results, not just hours.</p>
                    </div>
                    <div class="p-6">
                        <div class="text-blue-600 mb-4 flex justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H2v-2a3 3 0 015.356-1.857M17 20v-9a2 2 0 00-2-2h-2V7a2 2 0 00-2-2H9a2 2 0 00-2 2v3H5a2 2 0 00-2 2v6m3-3h10v-2H6v2zm0 0v2H6" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Collaborative Environment</h3>
                        <p class="text-gray-600">Work alongside passionate experts in a supportive and open environment.</p>
                    </div>
                    <div class="p-6">
                        <div class="text-blue-600 mb-4 flex justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 8c1.657 0 3 .895 3 2s-1.343 2-3 2-3-.895-3-2 1.343-2 3-2z" />
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Meaningful Equity</h3>
                        <p class="text-gray-600">Be a true owner in our journey with competitive equity packages.</p>
                    </div>
                    <div class="p-6">
                        <div class="text-blue-600 mb-4 flex justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" d="M10 12H7m3 0l3-3m-3 3l3 3m-3-3v3m0-3V9m0 3h3m0 0l-3-3m3 3l-3 3m-3-3h3m0 0l-3-3m3 3l-3 3" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Global Impact</h3>
                        <p class="text-gray-600">Contribute to securing critical systems worldwide, from India to the globe.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Job Listings Section -->
        <section id="job-listings-section" class="py-16">
             <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <h2 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">Current Openings</h2>
                    <p class="mt-4 max-w-2xl mx-auto text-lg text-gray-600">
                        Explore the roles we're actively hiring for. Don't see a fit? Reach out anyway!
                    </p>
                </div>

                <!-- Search Bar -->
                <div class="mt-8 mb-8 max-w-xl mx-auto">
                    <input type="text" id="job-search-input" placeholder="Search job titles or keywords..." class="form-input w-full px-4 py-2 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500" aria-label="Search job listings">
                </div>

                <!-- Filter Buttons -->
                <div id="job-filters" class="mt-12 flex justify-center flex-wrap gap-3">
                    <button class="filter-button active" data-filter="all">All</button>
                    <button class="filter-button" data-filter="engineering">Engineering</button>
                    <button class="filter-button" data-filter="security">Security</button>
                    <button class="filter-button" data-filter="analyst">Analyst/Consulting</button>
                    <button class="filter-button" data-filter="writing">Writing</button>
                    <button class="filter-button" data-filter="research">Student Research</button>
                    <button class="filter-button" data-filter="hardware">Hardware</button>
                </div>

                <!-- Job Cards Grid - This will be populated dynamically by JavaScript -->
                <div class="mt-10 grid grid-cols-1 md:grid-cols-2 gap-8" id="job-listings">
                    <!-- Job cards will be inserted here -->
                </div>
            </div>
        </section>

        <!-- Advisor Application Form Container -->
        <div id="advisor-application-container" class="hidden mt-16 max-w-3xl mx-auto">
            <form id="advisor-application-form" class="p-8 sm:p-10 card">
                <input type="hidden" name="_subject" value="Advisor Inquiry from Careers Page">
                <button type="button" id="back-to-main-advisor-page-button" class="text-gray-600 hover:text-gray-900 mb-6 flex items-center font-semibold" aria-label="Back to Advisor Invitation">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
                    Back to Advisor Invitation
                </button>
                <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-6">Express Interest in Advisory Role</h2>
                
                <div class="space-y-6">
                    <div><label for="advisor-name" class="form-field-label block mb-2">Name<span class="text-red-500">*</span></label><input type="text" name="name" id="advisor-name" class="form-input w-full" placeholder="Your Full Name" required /></div>
                    <div><label for="advisor-email" class="form-field-label block mb-2">Email<span class="text-red-500">*</span></label><input type="email" name="email" id="advisor-email" class="form-input w-full" placeholder="you@example.com" required /></div>
                    <div><label for="advisor-expertise" class="form-field-label block mb-2">Your Key Area(s) of Expertise<span class="text-red-500">*</span></label><textarea name="expertise" id="advisor-expertise" class="form-textarea w-full" rows="2" placeholder="e.g., Post-Quantum Cryptography, Cybersecurity Strategy, Quantum Computing..." required></textarea></div>
                    <div><label for="advisor-interest" class="form-field-label block mb-2">Briefly state your interest and how you might contribute:</label><textarea name="interest_reason" id="advisor-interest" class="form-textarea w-full" rows="3" placeholder="Keep it concise and to the point."></textarea></div>
                    <div class="pt-2">
                        <button type="submit" id="submit-advisor-application-button" class="w-full bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold text-lg hover:bg-blue-800 transition disabled:bg-gray-400">
                            Submit Interest
                        </button>
                    </div>
                </div>
            </form>
            <!-- Success Message Container for Advisor Form -->
            <div id="advisor-form-success-message" class="hidden text-center py-10 card"></div>
        </div>

        <!-- Job Application Form Container -->
        <div id="job-application-container" class="hidden mt-16 max-w-3xl mx-auto">
            <!-- The Form Itself -->
            <form id="job-application-form" class="p-8 sm:p-10 card">
                <input type="hidden" name="job_title" id="hidden-job-title">
                <button type="button" id="back-to-jobs-button" class="text-gray-600 hover:text-gray-900 mb-6 flex items-center font-semibold" aria-label="Back to Job Listings">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
                    Back to Job Listings
                </button>
                <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-6">Apply for <span id="application-job-title" class="text-blue-600"></span></h2>
                
                <div class="space-y-6">
                    <div><label for="applicant-name" class="form-field-label block mb-2">Name<span class="text-red-500">*</span></label><input type="text" name="name" id="applicant-name" class="form-input w-full" placeholder="Your Full Name" required /></div>
                    <div><label for="applicant-email" class="form-field-label block mb-2">Email<span class="text-red-500">*</span></label><input type="email" name="email" id="applicant-email" class="form-input w-full" placeholder="you@example.com" required /></div>
                    <div><label for="applicant-location" class="form-field-label block mb-2">Location (City, Country)</label><input type="text" name="location" id="applicant-location" class="form-input w-full" placeholder="e.g., Bengaluru, India"/></div>
                    <div><label for="linkedin-profile" class="form-field-label block mb-2">LinkedIn Profile (URL)</label><input type="url" name="linkedin_url" id="linkedin-profile" class="form-input w-full" placeholder="https://linkedin.com/in/yourprofile"/></div>
                    <div><label for="portfolio-site" class="form-field-label block mb-2">Portfolio, GitHub, or Personal Site (URL)</label><input type="url" name="portfolio_url" id="portfolio-site" class="form-input w-full" placeholder="https://github.com/yourprofile"/></div>
                    <div>
                        <label class="form-field-label block mb-2">Resume / CV</label>
                        <div class="flex items-center border border-gray-300 rounded-md p-3 bg-gray-50">
                            <button type="button" id="upload-resume-button" class="bg-gray-200 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-300 transition flex items-center" aria-label="Upload Resume">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/></svg>
                                Upload File
                            </button>
                            <span class="ml-3 text-gray-500 italic text-sm">No file chosen (Attach manually in email)</span>
                        </div>
                        <input type="file" id="resume-file-input" class="hidden" disabled/>
                    </div>
                    <div><label for="motivations" class="form-field-label block mb-2">Why are you interested in Moontrace Engineering?</label><textarea name="motivations" id="motivations" class="form-textarea w-full" rows="5" placeholder="Tell us about your interest..."></textarea></div>
                    <div><label for="project-problem" class="form-field-label block mb-2">Briefly describe a recent project or challenge you're proud of:</label><textarea name="project_challenge" id="project-problem" class="form-textarea w-full" rows="7" placeholder="Keep it short, thoughtful, and human."></textarea></div>
                    <div><label for="how-heard" class="form-field-label block mb-2">How did you hear about us?</label><input type="text" name="how_heard" id="how-heard" class="form-input w-full" placeholder="e.g., LinkedIn, referral, Google Search"/></div>
                    <div class="pt-2">
                        <button type="submit" id="submit-application-button" class="w-full bg-black text-white px-6 py-3 rounded-lg font-semibold text-lg hover:bg-gray-800 transition disabled:bg-gray-400">
                            Submit Application
                        </button>
                    </div>
                </div>
            </form>
            <!-- Success Message Container -->
            <div id="form-success-message" class="hidden text-center py-10 card"></div>
        </div>

        <!-- Job Details Modal Structure -->
        <div id="job-details-modal-overlay" class="modal-overlay hidden-display" aria-modal="true" role="dialog">
            <div class="modal-content">
                <button id="job-details-modal-close" class="modal-close-button" aria-label="Close job details">×</button>
                <h3 id="modal-job-title" class="text-2xl sm:text-3xl font-bold text-gray-900 mb-2"></h3>
                <p id="modal-job-location" class="text-gray-600 font-semibold mb-4"></p>
                <div id="modal-job-description" class="text-gray-700 leading-relaxed mb-6">
                    <!-- Detailed description will be injected here -->
                </div>
                <button id="modal-apply-button" class="apply-now-button px-6 py-3 text-lg w-full" aria-label="Apply for this role">Apply for this Role</button>
            </div>
        </div>
    </main>

    <footer class="bg-gray-900 text-gray-400">
        <div class="text-center py-6">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <p>&copy; 2025 Moontrace Engineering Research and Consulting | All Rights Reserved.</p>
                <p class="mt-2">Built in India, for the World.</p>
                <p class="mt-4"><a href="#" class="hover:underline">Back to top</a></p>
            </div>
        </div>
    </footer>

    <!-- IMPORTANT: 'jobs.js' must be included before this script block -->
    <script src="jobs.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- Global variable references ---
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const mobileMenu = document.getElementById('mobile-menu');
            const jobListingsSection = document.getElementById('job-listings-section');
            const jobListingsContainer = document.getElementById('job-listings');
            const jobApplicationContainer = document.getElementById('job-application-container');
            const advisorApplicationContainer = document.getElementById('advisor-application-container');
            const applicationJobTitle = document.getElementById('application-job-title');
            const hiddenJobTitleInput = document.getElementById('hidden-job-title');
            const jobApplicationForm = document.getElementById('job-application-form');
            const advisorApplicationForm = document.getElementById('advisor-application-form');
            const successMessageContainer = document.getElementById('form-success-message');
            const advisorSuccessMessageContainer = document.getElementById('advisor-form-success-message');
            const jobSearchInput = document.getElementById('job-search-input');
            const jobFilters = document.getElementById('job-filters');
            const jobDetailsModalOverlay = document.getElementById('job-details-modal-overlay');
            const jobDetailsModalClose = document.getElementById('job-details-modal-close');
            const modalJobTitle = document.getElementById('modal-job-title');
            const modalJobLocation = document.getElementById('modal-job-location');
            const modalJobDescription = document.getElementById('modal-job-description');
            const modalApplyButton = document.getElementById('modal-apply-button');
            const expressInterestAdvisorButton = document.getElementById('express-interest-advisor');

            // --- Function to render job listings ---
            function renderJobListings(jobs) {
                jobListingsContainer.innerHTML = ''; // Clear previous listings
                if (jobs.length === 0) {
                    jobListingsContainer.innerHTML = `<p class="text-center text-gray-500 md:col-span-2">No job listings match your criteria.</p>`;
                    return;
                }
                jobs.forEach(job => {
                    const jobCardHTML = `
                        <div class="job-card-compact card p-6 sm:p-8" data-category="${job.category}" data-job-details-id="${job.id}">
                            <button class="job-card-header w-full flex justify-between items-center text-left">
                                <div>
                                    <h3 class="text-xl sm:text-2xl font-bold text-gray-900 mb-1">${job.title}</h3>
                                    <p class="text-gray-600 font-semibold">${job.location}</p>
                                </div>
                                <span class="job-card-icon text-gray-400">+</span>
                            </button>
                            <div class="job-card-content border-t border-gray-200 pt-5 text-gray-600">
                                <p class="text-gray-700 mb-4">${job.shortDescription}</p>
                                <button class="apply-now-button" data-job-title="${job.title}">Apply Now</button>
                            </div>
                        </div>
                    `;
                    jobListingsContainer.insertAdjacentHTML('beforeend', jobCardHTML);
                });
            }

            // --- Initial Render ---
            // 'jobData' is available from the included 'jobs.js' file
            if (typeof jobData !== 'undefined') {
                renderJobListings(jobData);
            } else {
                console.error("jobData is not defined. Make sure jobs.js is loaded correctly.");
                jobListingsContainer.innerHTML = `<p class="text-center text-red-500 md:col-span-2">Error: Could not load job listings.</p>`;
            }


            // --- Mobile menu toggle logic ---
            mobileMenuToggle.addEventListener('click', function () {
                mobileMenu.classList.toggle('hidden');
            });
            document.addEventListener('click', function (e) {
                if (!mobileMenuToggle.contains(e.target) && !mobileMenu.contains(e.target)) {
                    mobileMenu.classList.add('hidden');
                }
            });

            // --- Dynamic Philosophy Text Logic ---
            const dynamicPhilosophyText = document.getElementById('dynamic-philosophy-text');
            const philosophyData = ["Build with Purpose", "One Team, One Goal", "Innovate Relentlessly", "Truth In Engineering"];
            let currentTextIndex = 0;

            function updatePhilosophyText() {
                dynamicPhilosophyText.classList.remove('show');
                setTimeout(() => {
                    dynamicPhilosophyText.textContent = philosophyData[currentTextIndex];
                    dynamicPhilosophyText.classList.add('show');
                    currentTextIndex = (currentTextIndex + 1) % philosophyData.length;
                }, 500);
            }
            updatePhilosophyText();
            setInterval(updatePhilosophyText, 3000);
            
            // --- Event Delegation for Dynamic Content (Job cards, apply buttons) ---
            jobListingsContainer.addEventListener('click', (event) => {
                const header = event.target.closest('.job-card-header');
                const applyButton = event.target.closest('.apply-now-button');

                // Accordion Logic
                if (header) {
                    const content = header.nextElementSibling;
                    const wasOpen = content.classList.contains('open');

                    document.querySelectorAll('.job-card-content.open').forEach(openContent => {
                        openContent.classList.remove('open');
                        openContent.previousElementSibling.classList.remove('open');
                    });

                    if (!wasOpen) {
                        content.classList.add('open');
                        header.classList.add('open');
                    }
                }

                // Apply Button Logic (opens modal)
                if (applyButton) {
                    event.stopPropagation();
                    const jobDetailsId = applyButton.closest('.job-card-compact').getAttribute('data-job-details-id');
                    const job = jobData.find(j => j.id === jobDetailsId);

                    if (job) {
                        modalJobTitle.textContent = job.title;
                        modalJobLocation.textContent = job.location;
                        modalJobDescription.innerHTML = job.details;
                        modalApplyButton.setAttribute('data-job-title', job.title);

                        jobDetailsModalOverlay.classList.remove('hidden-display');
                        jobDetailsModalOverlay.classList.add('show');
                        document.body.style.overflow = 'hidden';
                    } else {
                        showMessageBox('Job details not found.', 'error');
                    }
                }
            });

            // --- Job Filter Logic ---
            jobFilters.addEventListener('click', (event) => {
                if (event.target.matches('.filter-button')) {
                    const button = event.target;
                    const filter = button.getAttribute('data-filter');

                    jobFilters.querySelectorAll('.filter-button').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    const filteredJobs = filter === 'all' ? jobData : jobData.filter(job => job.category === filter);
                    renderJobListings(filteredJobs);
                    jobSearchInput.value = '';
                }
            });

            // --- Job Search Logic ---
            jobSearchInput.addEventListener('keyup', () => {
                const searchTerm = jobSearchInput.value.toLowerCase();
                jobFilters.querySelectorAll('.filter-button').forEach(btn => btn.classList.remove('active'));

                const searchedJobs = jobData.filter(job => 
                    job.title.toLowerCase().includes(searchTerm) ||
                    job.location.toLowerCase().includes(searchTerm) ||
                    job.shortDescription.toLowerCase().includes(searchTerm)
                );
                renderJobListings(searchedJobs);
            });

            // --- Job Details Modal Close Logic ---
            function closeModal() {
                jobDetailsModalOverlay.classList.remove('show');
                setTimeout(() => jobDetailsModalOverlay.classList.add('hidden-display'), 300);
                document.body.style.overflow = '';
            }
            jobDetailsModalClose.addEventListener('click', closeModal);
            jobDetailsModalOverlay.addEventListener('click', (event) => {
                if (event.target === jobDetailsModalOverlay) closeModal();
            });

            // --- Modal Apply Button to Main Job Form Logic ---
            modalApplyButton.addEventListener('click', () => {
                const jobTitle = modalApplyButton.getAttribute('data-job-title');
                applicationJobTitle.textContent = jobTitle;
                hiddenJobTitleInput.value = jobTitle;
                
                closeModal();
                
                jobListingsSection.classList.add('hidden');
                advisorApplicationContainer.classList.add('hidden');
                jobApplicationContainer.classList.remove('hidden');
                jobApplicationForm.classList.remove('hidden');
                successMessageContainer.classList.add('hidden');
                
                jobApplicationContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });


            // --- Form Navigation Logic ---
            document.getElementById('back-to-jobs-button').addEventListener('click', () => {
                jobApplicationContainer.classList.add('hidden');
                jobListingsSection.classList.remove('hidden');
                window.scrollTo({ top: jobListingsSection.offsetTop - 100, behavior: 'smooth' });
            });
            
            document.getElementById('back-to-main-advisor-page-button').addEventListener('click', () => {
                advisorApplicationContainer.classList.add('hidden');
                jobListingsSection.classList.remove('hidden');
                document.getElementById('advisor-invitation').scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

            // --- "Express Interest" button for Advisor role logic ---
            expressInterestAdvisorButton.addEventListener('click', () => {
                jobListingsSection.classList.add('hidden');
                jobApplicationContainer.classList.add('hidden');
                advisorApplicationContainer.classList.remove('hidden');
                advisorApplicationForm.classList.remove('hidden');
                advisorSuccessMessageContainer.classList.add('hidden');
                
                advisorApplicationContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

            // --- Job Application Form Submission Handler (AJAX) ---
            jobApplicationForm.addEventListener('submit', function(event) {
                event.preventDefault();
                const submitButton = document.getElementById('submit-application-button');
                const formData = new FormData(jobApplicationForm);
                const applicantName = formData.get('name');
                const applicantEmail = formData.get('email');

                if (!applicantName || !applicantEmail) {
                    showMessageBox('Please fill out all required fields (*).', 'error');
                    return;
                }

                submitButton.disabled = true;
                submitButton.textContent = 'Submitting...';

                fetch('https://formspree.io/f/mvgqaege', { 
                    method: 'POST', body: formData, headers: {'Accept': 'application/json'}
                }).then(response => {
                    if (response.ok) {
                        jobApplicationForm.classList.add('hidden');
                        successMessageContainer.innerHTML = `
                            <h2 class="text-3xl font-bold text-gray-900 mb-4">Thank You, ${applicantName}!</h2>
                            <p class="text-lg text-gray-600">Your application for the "${hiddenJobTitleInput.value}" role has been received.</p>
                            <p class="text-lg text-gray-600 mt-2">We'll review it and contact you at ${applicantEmail} if there's a potential fit.</p>
                            <button id="back-to-jobs-button-after-submit" class="mt-8 bg-black text-white px-6 py-2 rounded-lg font-semibold hover:bg-gray-800 transition">Back to All Job Listings</button>`;
                        successMessageContainer.classList.remove('hidden');
                        document.getElementById('back-to-jobs-button-after-submit').addEventListener('click', () => window.location.reload());
                    } else {
                        response.json().then(data => showMessageBox(`Oops! ${data.errors ? data.errors.map(e => e.message).join(', ') : 'Form submission error.'}`, 'error'));
                        submitButton.disabled = false;
                        submitButton.textContent = 'Submit Application';
                    }
                }).catch(error => {
                    showMessageBox('Oops! There was a network error. Please try again.', 'error');
                    submitButton.disabled = false;
                    submitButton.textContent = 'Submit Application';
                });
            });

            // --- Advisor Application Form Submission Handler (AJAX) ---
            advisorApplicationForm.addEventListener('submit', function(event) {
                event.preventDefault();
                const submitButton = document.getElementById('submit-advisor-application-button');
                const formData = new FormData(advisorApplicationForm);
                const advisorName = formData.get('name');

                if (!advisorName || !formData.get('email') || !formData.get('expertise')) {
                    showMessageBox('Please fill out all required fields (*).', 'error');
                    return;
                }

                submitButton.disabled = true;
                submitButton.textContent = 'Submitting...';

                fetch('https://formspree.io/f/xjkozlng', { 
                    method: 'POST', body: formData, headers: {'Accept': 'application/json'}
                }).then(response => {
                    if (response.ok) {
                        advisorApplicationForm.classList.add('hidden');
                        advisorSuccessMessageContainer.innerHTML = `
                            <h2 class="text-3xl font-bold text-gray-900 mb-4">Thank You, ${advisorName}!</h2>
                            <p class="text-lg text-gray-600">Your interest has been received. We'll be in touch at ${formData.get('email')}.</p>
                            <button id="back-to-advisor-after-submit" class="mt-8 bg-blue-700 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-800 transition">Back to Careers Page</button>`;
                        advisorSuccessMessageContainer.classList.remove('hidden');
                        document.getElementById('back-to-advisor-after-submit').addEventListener('click', () => window.location.reload());
                    } else {
                        response.json().then(data => showMessageBox(`Oops! ${data.errors ? data.errors.map(e => e.message).join(', ') : 'Form submission error.'}`, 'error'));
                        submitButton.disabled = false;
                        submitButton.textContent = 'Submit Interest';
                    }
                }).catch(error => {
                    showMessageBox('Oops! There was a network error. Please try again.', 'error');
                    submitButton.disabled = false;
                    submitButton.textContent = 'Submit Interest';
                });
            });

            // --- Custom Message Box Function ---
            function showMessageBox(message, type = 'error') {
                const messageBox = document.createElement('div');
                messageBox.className = `message-box ${type}`;
                messageBox.textContent = message;
                document.body.appendChild(messageBox);
                
                setTimeout(() => messageBox.classList.add('show'), 10);
                setTimeout(() => {
                    messageBox.classList.remove('show');
                    setTimeout(() => messageBox.remove(), 300);
                }, 3000);
            }
        });
    </script>

</body>
</html>
